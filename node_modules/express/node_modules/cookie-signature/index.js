
/**
 * Module dependencies.
 */

var crypto = require('crypto');

/**
 * Sign the given `val` with `***REMOVED***`.
 *
 * @param {String} val
 * @param {String} ***REMOVED***
 * @return {String}
 * @api private
 */

exports.sign = function(val, ***REMOVED***){
  if ('string' != typeof val) throw new TypeError('cookie required');
  if ('string' != typeof ***REMOVED***) throw new TypeError('***REMOVED*** required');
  return val + '.' + crypto
    .createHmac('sha256', ***REMOVED***)
    .update(val)
    .digest('base64')
    .replace(/\=+$/, '');
};

/**
 * Unsign and decode the given `val` with `***REMOVED***`,
 * returning `false` if the signature is invalid.
 *
 * @param {String} val
 * @param {String} ***REMOVED***
 * @return {String|Boolean}
 * @api private
 */

exports.unsign = function(val, ***REMOVED***){
  if ('string' != typeof val) throw new TypeError('cookie required');
  if ('string' != typeof ***REMOVED***) throw new TypeError('***REMOVED*** required');
  var str = val.slice(0, val.lastIndexOf('.'));
  return exports.sign(str, ***REMOVED***) == val ? str : false;
};
