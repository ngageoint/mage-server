<div class="saml-settings">
  <div class="mat-subheading-2">Identity Provider (IdP)</div>
  <mat-form-field appearance="outline">
    <mat-label>Entry Point</mat-label>
    <input matInput type="text" required [readonly]="!editable" [(ngModel)]="strategy.settings.options.entryPoint">
    <mat-hint align="end">
      Location of the IdP. This can be the location of the single sign-on identity provider.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Issuer</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.options.issuer">
    <mat-hint align="end">
      This is given to the IdP.
    </mat-hint>
  </mat-form-field>

  <div class="mat-subheading-2">Security</div>

  <mat-form-field appearance="outline">
    <mat-label>IdP Public Signing Certificate</mat-label>
    <textarea matInput [readonly]="!editable" [(ngModel)]="strategy.settings.cert"
      [ngModelOptions]="{standalone: true}"></textarea>
    <mat-hint align="end">
      The public signing certificate used to validate the signatures of the incoming SAML Responses.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Private Key</mat-label>
    <textarea matInput [readonly]="!editable" [(ngModel)]="strategy.settings.privateCert"
      [ngModelOptions]="{standalone: true}"></textarea>
    <mat-hint align="end">
      Private key used to sign requests. Supports well formatted PEM or single-line.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Decryption Private Key</mat-label>
    <textarea matInput [readonly]="!editable" [(ngModel)]="strategy.settings.decryptionPvk"
      [ngModelOptions]="{standalone: true}"></textarea>
    <mat-hint align="end">
      Private key that will be used to attempt to decrypt any encrypted assertions that are received. Supports well
      formatted PEM or single-line.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Signature Algorithm</mat-label>
    <mat-select [(ngModel)]="strategy.settings.signatureAlgorithm" [ngModelOptions]="{standalone: true}">
      <mat-option *ngFor="let algorithm of signatureAlgorithms" [value]="algorithm.value">
        {{algorithm.viewValue}}
      </mat-option>
    </mat-select>
    <mat-hint align="end">
      Signature algorithm for signing requests. Default of SHA-1.
    </mat-hint>
  </mat-form-field>

  <div class="mat-subheading-2">Issuer Validation</div>

  <mat-form-field appearance="outline">
    <mat-label>IdP Issuer</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.options.idpIssuer">
    <mat-hint align="end">
      The IdP issuer will be validated for incoming Logout Requests/Responses.
    </mat-hint>
  </mat-form-field>

  <div class="mat-subheading-2">Additional SAML Parameters</div>

  <mat-form-field appearance="outline">
    <mat-label>Audience</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.audience">
    <mat-hint align="end">
      Expected response Audience.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Identifier Format</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.identifierFormat">
    <mat-hint align="end">
      Name identifier format to request from identity provider.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Clock Skew</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.acceptedClockSkewMs">
    <mat-hint align="end">
      Time in milliseconds of skew that is acceptable between client and server when checking NotBefore and NotOnOrAfter
      assertion condition validity timestamps. Setting to -1 will disable checking these conditions entirely. Default is
      0.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Attribute Consuming Service Index</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.attributeConsumingServiceIndex">
    <mat-hint align="end">
      Instructs the IDP which attribute set to attach to the response.
    </mat-hint>
  </mat-form-field>

  <div class="disableRequestedAuthnContext">
    <mat-checkbox [disabled]="!editable" color="primary" [(ngModel)]="strategy.settings.disableRequestedAuthnContext">
    </mat-checkbox>
    <mat-label>Disable Requested Authn Context</mat-label>
    <div class="mat-caption">
      Do not request a specific authentication context. This is known to help when authenticating against Active
      Directory (AD FS) servers.
    </div>
  </div>

  <mat-form-field appearance="outline">
    <mat-label>Authn context</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.authnContext">
    <mat-hint align="end">
      Name identifier format to request auth context.
    </mat-hint>
  </mat-form-field>

  <div class="disableRequestedAuthnContext">
    <mat-checkbox [disabled]="!editable" color="primary" [(ngModel)]="strategy.settings.forceAuthn">
    </mat-checkbox>
    <mat-label>Force Authn</mat-label>
    <div class="mat-caption">
      The IdP should force re-authentication of the user, even if they possess a valid session.
    </div>
  </div>

  <div class="disableRequestedAuthnContext">
    <mat-checkbox [disabled]="!editable" color="primary" [(ngModel)]="strategy.settings.skipRequestCompression">
    </mat-checkbox>
    <mat-label>Skip Request Compression</mat-label>
    <div class="mat-caption">
      The request from the service provider won't be compressed.
    </div>
  </div>

  <mat-form-field appearance="outline">
    <mat-label>Authn Request Binding</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.authnRequestBinding">
    <mat-hint align="end">
      If set to HTTP-POST, will request authentication from IDP via HTTP POST binding, otherwise defaults to HTTP
      Redirect.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>RAC Comparison</mat-label>
    <mat-select [(ngModel)]="strategy.settings.RACComparison" [ngModelOptions]="{standalone: true}">
      <mat-option *ngFor="let rac of racs" [value]="rac.value">
        {{rac.viewValue}}
      </mat-option>
    </mat-select>
    <mat-hint align="end">
      Requested Authentication Context comparison type. Default is Exact.
    </mat-hint>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Provider Name</mat-label>
    <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.providerName">
    <mat-hint align="end">
      Human-readable name of the requester for use by the presenter's user agent or the identity provider.
    </mat-hint>
  </mat-form-field>

  <mat-accordion class="accordian-section">
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Advanced
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div class="mat-subheading-1">User Profile</div>
      <mat-form-field appearance="outline">
        <mat-label>Profile ID Property</mat-label>
        <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.profile.id">
        <mat-hint align="end">
          The id property that is returned in the user profile. Defaults to 'uid'.
        </mat-hint>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Display Name Property</mat-label>
        <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.profile.displayName">
        <mat-hint align="end">
          The display name property that is returned in the user profile. Defaults to 'email'.
        </mat-hint>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Email Name Property</mat-label>
        <input matInput type="text" [readonly]="!editable" [(ngModel)]="strategy.settings.profile.email">
        <mat-hint align="end">
          The email property that is returned in the user profile. Defaults to 'email'.
        </mat-hint>
      </mat-form-field>
    </mat-expansion-panel>
  </mat-accordion>
</div>