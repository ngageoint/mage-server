<div class="admin-nav-gap">
  <div class="container-fluid">
    <ol class="breadcrumb">
      <li><i class="fa fa-calendar admin-dashboard"></i><a ui-sref="admin.events">Events</a></li>
      <li><a ui-sref="admin.event({ eventId: $ctrl.event.id })">{{ $ctrl.event.name }}</a></li>
      <li><a ui-sref="admin.formEdit({ eventId: $ctrl.event.id, formId: $ctrl.form.id })">{{ $ctrl.form.name }}</a></li>
      <li class="active">Feed Configuration <span class="text-danger" ng-show="$ctrl.unSavedChanges"> (unsaved changes)</span></li>
    </ol>
  </div>
</div>

<div class="container" ng-show="$ctrl.event">
  <div class="row">
    <div class="col-md-12">
      <h2 ng-if="form.id">Edit Feed Configuration for form: {{$ctrl.form.name}}</h2>
    </div>
  </div>

  <div class="row top-gap-l">
    <div class="col-md-12">
      <nav class="navbar navbar-default admin-dashboard-navbar">
        <div class="container-fluid">
          <div class="navbar-header">
            <a class="navbar-brand">Feed Configuration</a>
          </div>
        </div>
      </nav>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-12">
      <div class="admin-table admin-table-content">
        <strong>Choose a primary field to be used in the feed:</strong>
        <div class="row bottom-gap">
          <div class="col-md-2">
            <select ng-model="$ctrl.form.primaryFeedField" ng-change="$ctrl.onFieldChanged()" ng-options="field.name as field.title for field in $ctrl.form.fields" class="form-control">
              <option value="">None</option>
            </select>
          </div>
        </div>

        <strong>Choose a secondary field to be used in the feed:</strong>
        <div class="row bottom-gap">
          <div class="col-md-2">
            <select ng-model="$ctrl.form.secondaryFeedField" ng-change="$ctrl.onFieldChanged()" ng-options="field.name as field.title for field in $ctrl.form.fields" class="form-control">
              <option value="">None</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row top-gap-l">
    <div class="col-md-12">
      <h4>Sample Observation Feed</h4>
      <div ng-repeat="observation in $ctrl.observations track by observation.id" observation-news-item="observation" event="$ctrl.event" selected-observation-form="$ctrl.form" container-element="side-bar"></div>
    </div>
  </div>
</div>

<div class="bottom-gap-l top-gap-xl">
  <div class="container" ng-if="$ctrl.event">
    <div class="row">
      <div class="col-xs-12">
        <button class="btn btn-success pull-right" ng-if="$ctrl.unSavedChanges && !$ctrl.saving" ng-click="$ctrl.save(event)" ng-disabled="$ctrl.form.fields.$invalid">Save</button>
        <button class="btn btn-success pull-right" ng-if="!$ctrl.unSavedChanges && !$ctrl.saving" disabled="disabled">Save</button>
        <button class="btn btn-success pull-right" ng-if="$ctrl.saving" disabled="disabled"><i class="fa fa-spinner fa-spin"></i> Saving</button>
      </div>
    </div>
  </div>
</div>