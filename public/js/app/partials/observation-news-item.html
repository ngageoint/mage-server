<div cl***REMOVED***="observation-news-item"  ng-init="editObservation = observation">
  <div ng-hide="editMode" ng-click="setActiveObservation(observation)" 
  ngm-tap="setActiveObservation(observation)">
  	<div cl***REMOVED***="row-fluid">
  		<div cl***REMOVED***="span2"><span marker-icon="observation"></span></div>
  		<div cl***REMOVED***="span10">
  			<div cl***REMOVED***="row-fluid">
  				<strong>{{observation.properties.TYPE}}</strong> <span cl***REMOVED***="pull-right news-feed-item-support small-text">{{observation.properties.EVENTDATE | moment: 'fromNow'}}</span>
  			</div>
  			<div cl***REMOVED***="row-fluid">
  				<div cl***REMOVED***="news-feed-item-support small-text pull-left" user-id="observation.properties.userId">{{user.firstname}} {{user.lastname}}</div>
  				<a cl***REMOVED***="pull-right small-text">{{observation.geometry.coordinates[0] | number: 3}}, {{observation.geometry.coordinates[1] | number: 3}}</a>
  			</div>
  		</div>
  	</div>
  	<div cl***REMOVED***="row-fluid top-gap-s">
  		{{observation.properties.DESCRIPTION}}
  	</div>
    <div cl***REMOVED***="map-clip row-fluid" style="width: 100%; height: 150px;" map-clip="mapClipConfig"/>

  	<div cl***REMOVED***="row-fluid top-gap-s bottom-gap-s">
  	  <div cl***REMOVED***="attachment" ng-repeat="attachment in observation.attachments track by attachment.id">
        <div cl***REMOVED***="image-button">
          <div ng-switch on="attachment.contentType">
            <a ng-switch-when="image/jpg" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/'+ observation.id + '/attachments/' + attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/'+ observation.id + '/attachments/' + attachment.id + '?access_token=' + token}}" style="width:150px"></a>
            <a ng-switch-when="image/jpeg" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" style="width:150px"></a>
            <a ng-switch-when="image/png" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" style="width:150px"></a>
            <a ng-switch-when="image/gif" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" style="width:150px"></a>
            <!-- Fix for octet stream images in an older version of the app -->
            <!-- Due to drastically varying browser behavior, videos will be a download link for the time being -->
            <div ng-switch-when="video/mp4">
              <video width="100%" height="320px" controls="controls">
              <source ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" type="video/mp4">
              </video>
              <a ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}">Download video</a>
            </div>
            <div ng-switch-default cl***REMOVED***="top-gap-l" style="width: 150px">
              <!-- try to see if we can figure out what type of thing it is by the extension -->
              <div ng-switch on="attachment.name.substr(attachment.name.lastIndexOf('.') + 1)">
                <a ng-switch-when="jpg" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/'+ observation.id + '/attachments/' + attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/'+ observation.id + '/attachments/' + attachment.id + '?access_token=' + token}}" style="width:150px"></a>
                <a ng-switch-when="jpeg" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" style="width:150px"></a>
                <a ng-switch-when="png" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" style="width:150px"></a>
                <a ng-switch-when="gif" ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" target="_blank"><img ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" style="width:150px"></a>
                <!-- Fix for octet stream images in an older version of the app -->
                <!-- Due to drastically varying browser behavior, videos will be a download link for the time being -->
                <div ng-switch-when="mp4">
                  <video width="100%" height="320px" controls="controls">
                  <source ng-src="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" type="video/mp4">
                  </video>
                  <a ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}">Download video</a>
                </div>
                <div ng-switch-default>
                  <a ng-href="{{'/FeatureServer/'+observation.layerId+'/features/' + observation.id + '/attachments/' +attachment.id + '?access_token=' + token}}" target="_blank">Download {{attachment.name}}</a>
                  <div><a ng-show="amAdmin" cl***REMOVED***="btn btn-danger" ng-click="deleteAttachment(attachment.id)">Delete</a></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  	</div>
    <button cl***REMOVED***="btn" ngm-tap="startEdit()" 
            ng-click="startEdit()">Edit</button>
  </div>
  <div ng-show="editMode">
    <div observation="editObservation" active-feature="editObservation" new-feature="newFeature" marker-location="markerLocation"></div>
  </div>


</div>