<div>  
  <!-- News Feed panel -->
  <div id="side-bar" cl***REMOVED***="side-bar-holder">
    <a cl***REMOVED***="close" aria-hidden="true" ngm-tap="newsFeedEnabled = false" ng-click="newsFeedEnabled = false">&times;</a>
    <div cl***REMOVED***="news-feed-pane" news-feed/>
  </div>
  <div cl***REMOVED***="map-filter" ng-hide="newsFeedEnabled">

  <div filter-navbar/>
    <div cl***REMOVED***="filter-panel" ng-show="showFilter">
      <h3>Filter</h3>
      <form cl***REMOVED***="form">
        <div cl***REMOVED***="control-group">
          <div cl***REMOVED***="controls">
            <label cl***REMOVED***="checkbox">
              <input type="checkbox" ng-model="locationServicesEnabled" ng-click="locationServices()" ng-tap="locationServices()"/><i cl***REMOVED***="icon-users" 
              ng-cl***REMOVED***="{false: 'icon-sage-inverse', true: 'icon-sage'}[locationServicesEnabled]"></i>Show People
              <!--<i cl***REMOVED***="icon-globe icon-spin" ng-show="loadingLayers[layer.id]" style="margin-left: 7px;"></i>-->
            </label>
          </div>
        </div>

        <div ng-show="featureLayers.length > 0">
          <div style="display: inline-block;">
            <h4 contenteditable="true">Feature Layers</h4>
          </div>
          <div cl***REMOVED***="control-group">
            <div cl***REMOVED***="controls">
              <label cl***REMOVED***="checkbox" ng-repeat="layer in featureLayers">
                <input type="checkbox" ng-model="layer.checked" ng-click="onFeatureLayer(layer)"/>{{layer.name}}
                <i cl***REMOVED***="icon-globe icon-spin" ng-show="loadingLayers[layer.id]" style="margin-left: 7px;"></i>
              </label>
            </div>
          </div>
        </div>

        <div ng-show="externalLayers.length > 0">
          <h4>External Layers</h4>
          <div cl***REMOVED***="control-group">
            <div cl***REMOVED***="controls">
              <label cl***REMOVED***="checkbox" ng-repeat="layer in externalLayers">
                <input type="checkbox" ng-model="layer.checked" ng-click="onFeatureLayer(layer)"/>{{layer.name}}
                <i cl***REMOVED***="icon-globe icon-spin" ng-show="loadingLayers[layer.id]" style="margin-left: 7px;"></i>
              </label>
            </div>
          </div>
        </div>

        <div ng-show="imageryLayers.length > 0">
          <h4>Imagery Layers</h4>
          <div cl***REMOVED***="control-group">
            <div cl***REMOVED***="controls">
              <label cl***REMOVED***="checkbox" ng-repeat="layer in imageryLayers">
                <input type="checkbox" ng-model="layer.checked" ng-click="onImageryLayer(layer)"/>{{layer.name}}
              </label>
            </div>
          </div>
        </div>
      </form>
    </div>
    <div cl***REMOVED***="feature-panel" ng-show="newObservationEnabled">
      <div observation="newFeature" active-feature="editObservation" new-feature="newFeature" marker-location="markerLocation"></div>
    </div>
  </div>

  <!-- The map directive -->
  <div id="map" cl***REMOVED***="map-wrap leaflet-container">
    <div leaflet marker-location="markerLocation" baselayer="baseLayer" layer="layer" message="message" draggable="true" active-feature="activeFeature" newfeature="newFeature" active-location="activeLocation" currentlayerid="currentLayerId" position="position" position-broadcast="positionBroadcast" locations="locations"></div>
  </div>
<!--
  <div ss-observation active-feature="activeFeature" new-feature="newFeature" marker-location="markerLocation"></div>-->
  <!-- <div pdc-observation active-feature="activeFeature" new-feature="newFeature" marker-location="markerLocation"></div> -->
  <!-- <div ***REMOVED***-observation active-feature="activeFeature" new-feature="newFeature" marker-location="markerLocation"></div> -->

  <!-- Third party observation dialog. Might be a good idea to generalize all the things and make them one observation panel at some point in time. -->
  <!-- <div external active-feature="activeFeature" currentlayerid="currentLayerId" layers="layers"></div> -->
  
  <!-- layer picker button 

  <button cl***REMOVED***="btn" ng-cl***REMOVED***="{true: 'btn-inverse'}[checkCurrentMapPanel('layers')]" id="settings" ng-click="setCurrentMapPanel('layers')" ngm-tap="setCurrentMapPanel('layers')"><i ng-cl***REMOVED***="checkCurrentMapPanel('layers') && 'icon-sage-inverse' || 'icon-sage'" cl***REMOVED***="icon-layers"></i></button>
-->
  <div id="new-feature-toolbar" cl***REMOVED***="leaflet-bar">
    <a
       ng-cl***REMOVED***="newObservationEnabled && 'btn-inverse'"
       ng-click="newObservation()" ngm-tap="newObservation()">
      <i cl***REMOVED***="icon-map-marker" ng-cl***REMOVED***="newObservationEnabled && 'icon-sage-inverse' || 'icon-sage'"></i>
    </a>
  </div>

  <div id="user-location-toolbar" cl***REMOVED***="leaflet-bar">
    <a 
      ng-cl***REMOVED***="{true: 'btn-inverse'}[locate]"
      ng-click="toggleLocate()" 
      ngm-tap="toggleLocate()">
      <i cl***REMOVED***="icon-target" ng-cl***REMOVED***="{true: 'icon-sage-inverse', false: 'icon-sage'}[locate]"></i>
    </a>

    <a 
      ng-cl***REMOVED***="{true: 'btn-inverse'}[broadcast]"
      ng-click="toggleBroadcast()" 
      ngm-tap="toggleBroadcast()">
      <i cl***REMOVED***="icon-megaphone" ng-cl***REMOVED***="{true: 'icon-sage-inverse', false: 'icon-sage'}[broadcast]"></i>
    </a>
  </div>
  <div id="list-tool-toolbars" cl***REMOVED***="leaflet-bar">
    <a 
      ng-cl***REMOVED***="{true: 'btn-inverse'}[checkCurrentMapPanel('export')]" 
      ng-click="setCurrentMapPanel('export')" 
      ngm-tap="setCurrentMapPanel('export')">
      <i ng-cl***REMOVED***="checkCurrentMapPanel('export') && 'icon-sage-inverse' || 'icon-sage'"cl***REMOVED***="icon-cloud-download"></i>
    </a>
    <a 
      ng-cl***REMOVED***="{true: 'btn-inverse'}[newsFeedEnabled]" 
      ng-click="newsFeedEnabled = !newsFeedEnabled" 
      ngm-tap="newsFeedEnabled = !newsFeedEnabled">
      <i ng-cl***REMOVED***="newsFeedEnabled && 'icon-sage-inverse' || 'icon-sage'"cl***REMOVED***="icon-rss"></i>
    </a>
  </div>

  <!-- Export panel -->
  <div export/>

</div>




